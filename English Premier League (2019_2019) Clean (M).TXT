let
    Source = Csv.Document(File.Contents("C:\Users\Alex Richt\Desktop\R Codes\EPL\Teams\2019_2020\EPLPlayerRankings_2019_2020.csv"),[Delimiter=",", Columns=11, Encoding=1252, QuoteStyle=QuoteStyle.Csv]),
    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
    #"Trimmed Text" = Table.TransformColumns(#"Promoted Headers",{{"LeagueLevel", Text.Trim, type text}}),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Trimmed Text", "CurrentMarketValue", Splitter.SplitTextByEachDelimiter({"€"}, QuoteStyle.Csv, true), {"CurrentMarketValue.1", "CurrentMarketValue.2"}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"CurrentMarketValue.1", type text}, {"CurrentMarketValue.2", type text}}),
    #"Trimmed Text1" = Table.TransformColumns(#"Changed Type1",{{"CurrentMarketValue.2", Text.Trim, type text}}),
    #"Renamed Columns" = Table.RenameColumns(#"Trimmed Text1",{{"CurrentMarketValue.2", "Last Market Value Update"}, {"CurrentMarketValue.1", "Market Value (Millions)"}}),
    #"Cleaned Text" = Table.TransformColumns(#"Renamed Columns",{{"Market Value (Millions)", Text.Clean, type text}}),
    #"Replaced Value" = Table.ReplaceValue(#"Cleaned Text","NA","",Replacer.ReplaceText,{"WorldRank"}),
    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","NA","",Replacer.ReplaceText,{"WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank"}),
    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",".",",",Replacer.ReplaceText,{"WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank"}),
    #"Changed Type" = Table.TransformColumnTypes(#"Replaced Value2",{{"WorldRank", type number}, {"CountryRank", type number}, {"PremierLeagueRank", type number}, {"PositionalRank", type number}, {"YearClassRank", type number}}),
    #"Replaced Value3" = Table.ReplaceValue(#"Changed Type",",",".",Replacer.ReplaceText,{"Market Value (Millions)"}),
    #"Split Column by Delimiter1" = Table.SplitColumn(#"Replaced Value3", "Market Value (Millions)", Splitter.SplitTextByDelimiter(" ", QuoteStyle.Csv), {"Market Value (Millions).1", "Market Value (Millions).2", "Market Value (Millions).3"}),
    #"Replaced Value4" = Table.ReplaceValue(#"Split Column by Delimiter1","NA","",Replacer.ReplaceText,{"Market Value (Millions).1"}),
    #"Changed Type2" = Table.TransformColumnTypes(#"Replaced Value4",{{"Market Value (Millions).1", type number}}),
    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type2",{{"Market Value (Millions).1", "Market Value"}}),
    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns1",{"Market Value (Millions).3"}),
    #"Added Conditional Column" = Table.AddColumn(#"Removed Columns", "Multiplier", each if [#"Market Value (Millions).2"] = "mil." then 1000000 else if [#"Market Value (Millions).2"] = "K" then 1000 else null),
    #"Reordered Columns" = Table.ReorderColumns(#"Added Conditional Column",{"", "PlayerName", "Market Value", "Multiplier", "Market Value (Millions).2", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank"}),
    #"Renamed Columns2" = Table.RenameColumns(#"Reordered Columns",{{"Market Value", "MarketValue"}}),
    #"Added Custom" = Table.AddColumn(#"Renamed Columns2", "Market Value", each Value.Multiply([MarketValue],[Multiplier])),
    #"Reordered Columns1" = Table.ReorderColumns(#"Added Custom",{"", "PlayerName", "Market Value", "MarketValue", "Multiplier", "Market Value (Millions).2", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank"}),
    #"Removed Columns1" = Table.RemoveColumns(#"Reordered Columns1",{"MarketValue", "Multiplier", "Market Value (Millions).2"}),
    #"Changed Type3" = Table.TransformColumnTypes(#"Removed Columns1",{{"Market Value", Int64.Type}}),
    #"Merged Queries" = Table.NestedJoin(#"Changed Type3", {"PlayerName"}, EPLRosterValues_2019_2020, {"PlayerName"}, "EPLRosterValues_2019_2020", JoinKind.LeftOuter),
    #"Expanded EPLRosterValues_2019_2020" = Table.ExpandTableColumn(#"Merged Queries", "EPLRosterValues_2019_2020", {"AccumulatedTransfersSum"}, {"EPLRosterValues_2019_2020.AccumulatedTransfersSum"}),
    #"Replaced Value5" = Table.ReplaceValue(#"Expanded EPLRosterValues_2019_2020",",",".",Replacer.ReplaceText,{"EPLRosterValues_2019_2020.AccumulatedTransfersSum"}),
    #"Split Column by Delimiter2" = Table.SplitColumn(#"Replaced Value5", "EPLRosterValues_2019_2020.AccumulatedTransfersSum", Splitter.SplitTextByDelimiter(" ", QuoteStyle.Csv), {"EPLRosterValues_2019_2020.AccumulatedTransfersSum.1", "EPLRosterValues_2019_2020.AccumulatedTransfersSum.2", "EPLRosterValues_2019_2020.AccumulatedTransfersSum.3"}),
    #"Changed Type4" = Table.TransformColumnTypes(#"Split Column by Delimiter2",{{"", Int64.Type}, {"PlayerName", type text}, {"JoinedClub", type date}, {"ContractUnitl", type text}, {"EPLRosterValues_2019_2020.AccumulatedTransfersSum.1", type number}, {"EPLRosterValues_2019_2020.AccumulatedTransfersSum.2", type text}, {"EPLRosterValues_2019_2020.AccumulatedTransfersSum.3", type text}}),
    #"Removed Columns2" = Table.RemoveColumns(#"Changed Type4",{"EPLRosterValues_2019_2020.AccumulatedTransfersSum.3"}),
    #"Added Conditional Column1" = Table.AddColumn(#"Removed Columns2", "Custom", each if [EPLRosterValues_2019_2020.AccumulatedTransfersSum.2] = "mil." then 1000000 else if [EPLRosterValues_2019_2020.AccumulatedTransfersSum.2] = "K" then 1000 else null),
    #"Added Custom1" = Table.AddColumn(#"Added Conditional Column1", "Accumulated Transfer Value", each Value.Multiply([EPLRosterValues_2019_2020.AccumulatedTransfersSum.1],[Custom])),
    #"Reordered Columns2" = Table.ReorderColumns(#"Added Custom1",{"", "PlayerName", "Market Value", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "Accumulated Transfer Value", "EPLRosterValues_2019_2020.AccumulatedTransfersSum.1", "EPLRosterValues_2019_2020.AccumulatedTransfersSum.2", "Custom"}),
    #"Changed Type5" = Table.TransformColumnTypes(#"Reordered Columns2",{{"Accumulated Transfer Value", Int64.Type}}),
    #"Changed Type with Locale" = Table.TransformColumnTypes(#"Changed Type5", {{"Accumulated Transfer Value", Currency.Type}}, "en-DE"),
    #"Removed Columns3" = Table.RemoveColumns(#"Changed Type with Locale",{"EPLRosterValues_2019_2020.AccumulatedTransfersSum.1", "EPLRosterValues_2019_2020.AccumulatedTransfersSum.2", "Custom"}),
    #"Reordered Columns3" = Table.ReorderColumns(#"Removed Columns3",{"", "PlayerName", "Market Value", "Last Market Value Update", "Accumulated Transfer Value", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank"}),
    #"Replaced Value6" = Table.ReplaceValue(#"Reordered Columns3","First Tier","English Premier League",Replacer.ReplaceText,{"LeagueLevel"}),
    #"Removed Columns4" = Table.RemoveColumns(#"Replaced Value6",{""}),
    #"Reordered Columns4" = Table.ReorderColumns(#"Removed Columns4",{"PlayerName", "Market Value", "Accumulated Transfer Value", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank"}),
    #"Renamed Columns3" = Table.RenameColumns(#"Reordered Columns4",{{"Accumulated Transfer Value", "Accumulated Transfer Sum"}}),
    #"Merged Queries1" = Table.NestedJoin(#"Renamed Columns3", {"PlayerName"}, InDepthEPLRosters_2019_2020, {"PlayerName"}, "InDepthEPLRosters_2019_2020", JoinKind.LeftOuter),
    #"Expanded InDepthEPLRosters_2019_2020" = Table.ExpandTableColumn(#"Merged Queries1", "InDepthEPLRosters_2019_2020", {"FullName", "Affiliation", "Jersey", "birthDate", "birthPlace", "height", "Foot"}, {"InDepthEPLRosters_2019_2020.FullName", "InDepthEPLRosters_2019_2020.Affiliation", "InDepthEPLRosters_2019_2020.Jersey", "InDepthEPLRosters_2019_2020.birthDate", "InDepthEPLRosters_2019_2020.birthPlace", "InDepthEPLRosters_2019_2020.height", "InDepthEPLRosters_2019_2020.Foot"}),
    #"Reordered Columns5" = Table.ReorderColumns(#"Expanded InDepthEPLRosters_2019_2020",{"InDepthEPLRosters_2019_2020.FullName", "PlayerName", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "InDepthEPLRosters_2019_2020.Affiliation", "InDepthEPLRosters_2019_2020.Jersey", "InDepthEPLRosters_2019_2020.birthDate", "InDepthEPLRosters_2019_2020.birthPlace", "InDepthEPLRosters_2019_2020.height", "InDepthEPLRosters_2019_2020.Foot"}),
    #"Renamed Columns4" = Table.RenameColumns(#"Reordered Columns5",{{"InDepthEPLRosters_2019_2020.FullName", "Full Name"}, {"PlayerName", "Player Name"}}),
    #"Reordered Columns6" = Table.ReorderColumns(#"Renamed Columns4",{"Full Name", "Player Name", "InDepthEPLRosters_2019_2020.Affiliation", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "InDepthEPLRosters_2019_2020.Jersey", "InDepthEPLRosters_2019_2020.birthDate", "InDepthEPLRosters_2019_2020.birthPlace", "InDepthEPLRosters_2019_2020.height", "InDepthEPLRosters_2019_2020.Foot"}),
    #"Renamed Columns5" = Table.RenameColumns(#"Reordered Columns6",{{"InDepthEPLRosters_2019_2020.Affiliation", "Club"}}),
    #"Reordered Columns7" = Table.ReorderColumns(#"Renamed Columns5",{"InDepthEPLRosters_2019_2020.Jersey", "Full Name", "Player Name", "Club", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "InDepthEPLRosters_2019_2020.birthDate", "InDepthEPLRosters_2019_2020.birthPlace", "InDepthEPLRosters_2019_2020.height", "InDepthEPLRosters_2019_2020.Foot"}),
    #"Renamed Columns6" = Table.RenameColumns(#"Reordered Columns7",{{"InDepthEPLRosters_2019_2020.Jersey", "Jersey Number"}}),
    #"Reordered Columns8" = Table.ReorderColumns(#"Renamed Columns6",{"Jersey Number", "Full Name", "Player Name", "Club", "InDepthEPLRosters_2019_2020.birthDate", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "InDepthEPLRosters_2019_2020.birthPlace", "InDepthEPLRosters_2019_2020.height", "InDepthEPLRosters_2019_2020.Foot"}),
    #"Renamed Columns7" = Table.RenameColumns(#"Reordered Columns8",{{"InDepthEPLRosters_2019_2020.birthDate", "Birth Date"}}),
    #"Trimmed Text2" = Table.TransformColumns(#"Renamed Columns7",{{"Birth Date", Text.Trim, type text}}),
    #"Cleaned Text1" = Table.TransformColumns(#"Trimmed Text2",{{"Birth Date", Text.Clean, type text}}),
    #"Replaced Value7" = Table.ReplaceValue(#"Cleaned Text1","("," ",Replacer.ReplaceText,{"Birth Date"}),
    #"Replaced Value8" = Table.ReplaceValue(#"Replaced Value7",")","",Replacer.ReplaceText,{"Birth Date"}),
    #"Split Column by Delimiter3" = Table.SplitColumn(#"Replaced Value8", "Birth Date", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, true), {"Birth Date.1", "Birth Date.2"}),
    #"Changed Type6" = Table.TransformColumnTypes(#"Split Column by Delimiter3",{{"Birth Date.1", type date}, {"Birth Date.2", Int64.Type}}),
    #"Renamed Columns8" = Table.RenameColumns(#"Changed Type6",{{"Birth Date.2", "Age"}, {"Birth Date.1", "Birth Date"}}),
    #"Reordered Columns9" = Table.ReorderColumns(#"Renamed Columns8",{"Jersey Number", "Full Name", "Player Name", "Club", "Birth Date", "Age", "InDepthEPLRosters_2019_2020.birthPlace", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "InDepthEPLRosters_2019_2020.height", "InDepthEPLRosters_2019_2020.Foot"}),
    #"Renamed Columns9" = Table.RenameColumns(#"Reordered Columns9",{{"InDepthEPLRosters_2019_2020.birthPlace", "Birth Place"}}),
    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns9",{"InDepthEPLRosters_2019_2020.Foot"}),
    #"Reordered Columns10" = Table.ReorderColumns(#"Removed Columns5",{"Jersey Number", "Full Name", "Player Name", "Club", "Birth Date", "Age", "Birth Place", "InDepthEPLRosters_2019_2020.height", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank"}),
    #"Renamed Columns10" = Table.RenameColumns(#"Reordered Columns10",{{"InDepthEPLRosters_2019_2020.height", "Height"}}),
    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns10",{"Full Name"}),
    #"Merged Queries2" = Table.NestedJoin(#"Removed Columns6", {"Player Name"}, #"In-Depth Corrected", {"PlayerName"}, "In-Depth Corrected", JoinKind.LeftOuter),
    #"Expanded In-Depth Corrected" = Table.ExpandTableColumn(#"Merged Queries2", "In-Depth Corrected", {"FullName", "Citizenship", "Foot", "Agent", "PlayerSponsor", "HighestMarketValue", "NationalTeamCaps", "MostRecentInjury"}, {"In-Depth Corrected.FullName", "In-Depth Corrected.Citizenship", "In-Depth Corrected.Foot", "In-Depth Corrected.Agent", "In-Depth Corrected.PlayerSponsor", "In-Depth Corrected.HighestMarketValue", "In-Depth Corrected.NationalTeamCaps", "In-Depth Corrected.MostRecentInjury"}),
    #"Reordered Columns11" = Table.ReorderColumns(#"Expanded In-Depth Corrected",{"Jersey Number", "In-Depth Corrected.FullName", "Player Name", "Club", "Birth Date", "Age", "Birth Place", "Height", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "In-Depth Corrected.Citizenship", "In-Depth Corrected.Foot", "In-Depth Corrected.Agent", "In-Depth Corrected.PlayerSponsor", "In-Depth Corrected.HighestMarketValue", "In-Depth Corrected.NationalTeamCaps", "In-Depth Corrected.MostRecentInjury"}),
    #"Renamed Columns11" = Table.RenameColumns(#"Reordered Columns11",{{"In-Depth Corrected.FullName", "Full Name"}}),
    #"Reordered Columns12" = Table.ReorderColumns(#"Renamed Columns11",{"Jersey Number", "Full Name", "Player Name", "Club", "Birth Date", "Age", "Birth Place", "Height", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "In-Depth Corrected.Citizenship", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "In-Depth Corrected.Foot", "In-Depth Corrected.Agent", "In-Depth Corrected.PlayerSponsor", "In-Depth Corrected.HighestMarketValue", "In-Depth Corrected.NationalTeamCaps", "In-Depth Corrected.MostRecentInjury"}),
    #"Renamed Columns12" = Table.RenameColumns(#"Reordered Columns12",{{"In-Depth Corrected.Citizenship", "Citizenships"}}),
    #"Reordered Columns13" = Table.ReorderColumns(#"Renamed Columns12",{"Jersey Number", "Full Name", "Player Name", "Club", "Birth Date", "Age", "Birth Place", "Height", "In-Depth Corrected.Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "LeagueLevel", "JoinedClub", "ContractUnitl", "Citizenships", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "In-Depth Corrected.Agent", "In-Depth Corrected.PlayerSponsor", "In-Depth Corrected.HighestMarketValue", "In-Depth Corrected.NationalTeamCaps", "In-Depth Corrected.MostRecentInjury"}),
    #"Renamed Columns13" = Table.RenameColumns(#"Reordered Columns13",{{"In-Depth Corrected.Foot", "Foot"}}),
    #"Reordered Columns14" = Table.ReorderColumns(#"Renamed Columns13",{"Jersey Number", "Full Name", "Player Name", "Club", "Birth Date", "Age", "Birth Place", "Height", "Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "In-Depth Corrected.Agent", "LeagueLevel", "JoinedClub", "ContractUnitl", "Citizenships", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "In-Depth Corrected.PlayerSponsor", "In-Depth Corrected.HighestMarketValue", "In-Depth Corrected.NationalTeamCaps", "In-Depth Corrected.MostRecentInjury"}),
    #"Renamed Columns14" = Table.RenameColumns(#"Reordered Columns14",{{"In-Depth Corrected.Agent", "Agent"}}),
    #"Reordered Columns15" = Table.ReorderColumns(#"Renamed Columns14",{"Jersey Number", "Full Name", "Player Name", "Club", "LeagueLevel", "Birth Date", "Age", "Birth Place", "Height", "Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "Agent", "JoinedClub", "ContractUnitl", "Citizenships", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "In-Depth Corrected.PlayerSponsor", "In-Depth Corrected.HighestMarketValue", "In-Depth Corrected.NationalTeamCaps", "In-Depth Corrected.MostRecentInjury"}),
    #"Renamed Columns15" = Table.RenameColumns(#"Reordered Columns15",{{"In-Depth Corrected.PlayerSponsor", "Player Sponsor"}}),
    #"Reordered Columns16" = Table.ReorderColumns(#"Renamed Columns15",{"Jersey Number", "Full Name", "Player Name", "Club", "LeagueLevel", "Birth Date", "Age", "Birth Place", "Height", "Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "Agent", "JoinedClub", "ContractUnitl", "Citizenships", "Player Sponsor", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "In-Depth Corrected.HighestMarketValue", "In-Depth Corrected.NationalTeamCaps", "In-Depth Corrected.MostRecentInjury"}),
    #"Renamed Columns16" = Table.RenameColumns(#"Reordered Columns16",{{"In-Depth Corrected.HighestMarketValue", "Highest Mart Value"}}),
    #"Replaced Value9" = Table.ReplaceValue(#"Renamed Columns16","_x000D_#(lf)                                                                                    Jun 13, 2019_x000D_#(lf)                                        ","",Replacer.ReplaceText,{"Highest Mart Value"}),
    #"Trimmed Text3" = Table.TransformColumns(#"Replaced Value9",{{"Highest Mart Value", Text.Trim, type text}}),
    #"Cleaned Text2" = Table.TransformColumns(#"Trimmed Text3",{{"Highest Mart Value", Text.Clean, type text}}),
    #"Trimmed Text4" = Table.TransformColumns(#"Cleaned Text2",{{"Highest Mart Value", Text.Trim, type text}}),
    #"Replaced Value10" = Table.ReplaceValue(#"Trimmed Text4","_x000D_                            ","",Replacer.ReplaceText,{"Highest Mart Value"}),
    #"Trimmed Text5" = Table.TransformColumns(#"Replaced Value10",{{"Highest Mart Value", Text.Trim, type text}}),
    #"Replaced Value11" = Table.ReplaceValue(#"Trimmed Text5","                                            Jun 13, 2019_x000D_","",Replacer.ReplaceText,{"Highest Mart Value"}),
    #"Trimmed Text6" = Table.TransformColumns(#"Replaced Value11",{{"Highest Mart Value", Text.Trim, type text}}),
    #"Cleaned Text3" = Table.TransformColumns(#"Trimmed Text6",{{"Highest Mart Value", Text.Clean, type text}}),
    #"Renamed Columns17" = Table.RenameColumns(#"Cleaned Text3",{{"In-Depth Corrected.NationalTeamCaps", "National Team Caps"}, {"In-Depth Corrected.MostRecentInjury", "Most Recent Injury"}}),
    #"Replaced Value12" = Table.ReplaceValue(#"Renamed Columns17","_x000D_#(lf)    _x000D_#(lf)        _x000D_#(lf)    _x000D_#(lf))","",Replacer.ReplaceText,{"Most Recent Injury"}),
    #"Trimmed Text7" = Table.TransformColumns(#"Replaced Value12",{{"Most Recent Injury", Text.Trim, type text}}),
    #"Cleaned Text4" = Table.TransformColumns(#"Trimmed Text7",{{"Most Recent Injury", Text.Clean, type text}}),
    #"Replaced Value13" = Table.ReplaceValue(#"Cleaned Text4","_x000D_    _x000D_        _x000D_    _x000D_ ","",Replacer.ReplaceText,{"Most Recent Injury"}),
    #"Cleaned Text5" = Table.TransformColumns(#"Replaced Value13",{{"Most Recent Injury", Text.Clean, type text}}),
    #"Trimmed Text8" = Table.TransformColumns(#"Cleaned Text5",{{"Most Recent Injury", Text.Trim, type text}}),
    #"Replaced Value14" = Table.ReplaceValue(#"Trimmed Text8","    _x000D_","",Replacer.ReplaceText,{"Most Recent Injury"}),
    #"Replaced Value15" = Table.ReplaceValue(#"Replaced Value14"," Return unknown","",Replacer.ReplaceText,{"Most Recent Injury"}),
    #"Replaced Value16" = Table.ReplaceValue(#"Replaced Value15","Return unknown"," - Return unknown",Replacer.ReplaceText,{"Most Recent Injury"}),
    #"Replaced Value17" = Table.ReplaceValue(#"Replaced Value16","Return expected on Dec 6, 2019"," - Return expected on Dec 6, 2019",Replacer.ReplaceText,{"Most Recent Injury"}),
    #"Replaced Value18" = Table.ReplaceValue(#"Replaced Value17","_x000D_","",Replacer.ReplaceText,{"Highest Mart Value"}),
    #"Trimmed Text9" = Table.TransformColumns(#"Replaced Value18",{{"Highest Mart Value", Text.Trim, type text}}),
    #"Cleaned Text6" = Table.TransformColumns(#"Trimmed Text9",{{"Highest Mart Value", Text.Clean, type text}}),
    #"Replaced Value19" = Table.ReplaceValue(#"Cleaned Text6","                                            "," ",Replacer.ReplaceText,{"Highest Mart Value"}),
    #"Replaced Value20" = Table.ReplaceValue(#"Replaced Value19",",",".",Replacer.ReplaceText,{"Highest Mart Value"}),
    #"Split Column by Delimiter4" = Table.SplitColumn(#"Replaced Value20", "Highest Mart Value", Splitter.SplitTextByDelimiter("€", QuoteStyle.Csv), {"Highest Mart Value.1", "Highest Mart Value.2"}),
    #"Changed Type7" = Table.TransformColumnTypes(#"Split Column by Delimiter4",{{"Highest Mart Value.1", type text}, {"Highest Mart Value.2", type date}}),
    #"Renamed Columns18" = Table.RenameColumns(#"Changed Type7",{{"Highest Mart Value.2", "Date of Highest Market Value"}, {"Highest Mart Value.1", "Highest Market Value"}}),
    #"Reordered Columns17" = Table.ReorderColumns(#"Renamed Columns18",{"Jersey Number", "Full Name", "Player Name", "Club", "LeagueLevel", "Birth Date", "Age", "Birth Place", "Height", "Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "Agent", "JoinedClub", "ContractUnitl", "Citizenships", "Player Sponsor", "National Team Caps", "Most Recent Injury", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "Highest Market Value", "Date of Highest Market Value"}),
    #"Split Column by Delimiter5" = Table.SplitColumn(#"Reordered Columns17", "Highest Market Value", Splitter.SplitTextByDelimiter(" ", QuoteStyle.Csv), {"Highest Market Value.1", "Highest Market Value.2", "Highest Market Value.3"}),
    #"Changed Type8" = Table.TransformColumnTypes(#"Split Column by Delimiter5",{{"Highest Market Value.1", type text}, {"Highest Market Value.2", type text}, {"Highest Market Value.3", type text}}),
    #"Added Conditional Column2" = Table.AddColumn(#"Changed Type8", "Custom", each if [Highest Market Value.2] = "mil." then 1000000 else if [Highest Market Value.2] = "K" then 1000 else null),
    #"Removed Columns7" = Table.RemoveColumns(#"Added Conditional Column2",{"Highest Market Value.3"}),
    #"Reordered Columns18" = Table.ReorderColumns(#"Removed Columns7",{"Jersey Number", "Full Name", "Player Name", "Club", "LeagueLevel", "Birth Date", "Age", "Birth Place", "Height", "Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "Agent", "JoinedClub", "ContractUnitl", "Citizenships", "Player Sponsor", "National Team Caps", "Most Recent Injury", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "Highest Market Value.1", "Highest Market Value.2", "Custom", "Date of Highest Market Value"}),
    #"Replaced Value21" = Table.ReplaceValue(#"Reordered Columns18","NA","",Replacer.ReplaceText,{"Highest Market Value.1"}),
    #"Changed Type9" = Table.TransformColumnTypes(#"Replaced Value21",{{"Highest Market Value.1", type number}, {"Custom", Int64.Type}}),
    #"Added Custom2" = Table.AddColumn(#"Changed Type9", "Highest Market Value", each Value.Multiply([Highest Market Value.1],[Custom])),
    #"Reordered Columns19" = Table.ReorderColumns(#"Added Custom2",{"Jersey Number", "Full Name", "Player Name", "Club", "LeagueLevel", "Birth Date", "Age", "Birth Place", "Height", "Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "Agent", "JoinedClub", "ContractUnitl", "Citizenships", "Player Sponsor", "National Team Caps", "Most Recent Injury", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "Highest Market Value", "Highest Market Value.1", "Highest Market Value.2", "Custom", "Date of Highest Market Value"}),
    #"Removed Columns8" = Table.RemoveColumns(#"Reordered Columns19",{"Highest Market Value.1", "Highest Market Value.2", "Custom"}),
    #"Merged Queries3" = Table.NestedJoin(#"Removed Columns8", {"Player Name"}, TeamRoster_2019_2020, {"P_URL"}, "TeamRoster_2019_2020", JoinKind.LeftOuter),
    #"Expanded TeamRoster_2019_2020" = Table.ExpandTableColumn(#"Merged Queries3", "TeamRoster_2019_2020", {"Team Name"}, {"TeamRoster_2019_2020.Team Name"}),
    #"Renamed Columns19" = Table.RenameColumns(#"Expanded TeamRoster_2019_2020",{{"TeamRoster_2019_2020.Team Name", "Team Name"}}),
    #"Reordered Columns20" = Table.ReorderColumns(#"Renamed Columns19",{"Jersey Number", "Full Name", "Player Name", "Team Name", "Club", "LeagueLevel", "Birth Date", "Age", "Birth Place", "Height", "Foot", "Market Value", "Accumulated Transfer Sum", "Last Market Value Update", "Agent", "JoinedClub", "ContractUnitl", "Citizenships", "Player Sponsor", "National Team Caps", "Most Recent Injury", "WorldRank", "CountryRank", "PremierLeagueRank", "PositionalRank", "YearClassRank", "Highest Market Value", "Date of Highest Market Value"}),
    #"Renamed Columns20" = Table.RenameColumns(#"Reordered Columns20",{{"Team Name", "Club Name"}, {"Club", "Club Name 2"}})
in
    #"Renamed Columns20"